<!DOCTYPE html>
<html>
<head>
  <title>CanUI Grid</title>
</head>
<body style="padding-top: 30px;">

<div class="container">
  <header class="well">
    <h1>CanUI Grid List Demo</h1>
    <form class="form">
      <fieldset>
        <legend>Filter</legend>
        <label>Age between</label>
        <input type="text" name="min-age" value="50" />
        <input type="text" name="max-age" value="80" />
        <p><input type="submit" class="btn" value="Update filter" id="update-filter" /></p>
      </fieldset>
    </form>
  </header>
  <section>
    <div id="grid"></div>
  </section>
</div>

<script type="text/javascript" src="../../steal/steal.js"></script>
<script type="text/javascript">
  steal('canui/grid', 'can/model', 'canui/style', 'canui/table_scroll', function () {

    // Setup
    var Model = can.Model({}),
        list = [];

    for (var i = 0; i < 100; i++) {
      list.push({ name : 'Test ' + i, age : Math.ceil(Math.random(100) * 100) });
    }

    // Model list
    var people = Model.models(list),
        getFilter = function() {
          return {
            min : parseInt($('[name="min-age"]').val()),
            max : parseInt($('[name="max-age"]').val())
          }
        },
        filter = new can.Observe(getFilter()),
        filterCompute = can.compute(function () {
          var folks = new can.Observe.List(), age;
          for (var i = 0; i < people.attr('length'); i++) {
            age = people.attr(i + '.age');
            if (age >= filter.attr('min') && age <= filter.attr('max')) {
              folks.push(people[i]);
            }
          }
          return folks;
        });

    var grid = new can.ui.Grid('#grid', {
      columns : [
        {
          header : 'Name',
          attr : 'name'
        },
        {
          header : 'Age',
          attr : 'age'
        },
        {
          header : 'Stuff',
          attr : function(element, index, data) {
            return element.attr('name') + ' (' + element.attr('age') + ')';
          }
        }
      ]
    });

    $('#update-filter').click(function(ev) {
      ev.preventDefault();
      filter.attr(getFilter());
    });

    $('#grid').trigger('loading', 'Custom loading text...');
    setTimeout(function() {
      grid.list(people);
    }, 1500);
  })
</script>
</body>
</html>